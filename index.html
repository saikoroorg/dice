<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
<title></title>
<link rel="icon" type="image/svg" href="icon.svg" />
<link rel="apple-touch-icon" href="icon.png" sizes="192x192" />
<link rel="manifest" href="app.json" />
<link rel="stylesheet" href="pico.css" />
</head>
<body>
<div id="container">
	<h1 id="header">
		<div class="logo">
			<a id="title" href="./index.html"></a>
			<a id="subtitle" href="javascript:top.location.reload();"></a>
		</div>
		<div class="menu center">
			<a class="item light secret" id="action" href="javascript:picoOnAction();">
				<span id="actionText"></span>
				<img class="icon" id="actionIcon" src="" />
			</a>
		</div>
		<div class="menu">
			<a class="item clear" id="minus" href="javascript:picoOnSelect(-1);">-</a>
			<a class="item light" id="select" href="javascript:picoOnSelect(0);">
				<span id="selectText"></span>
				<img class="icon" id="selectIcon" src="" />
			</a>
			<a class="item clear" id="plus" href="javascript:picoOnSelect(+1);">+</a>
		</div>
	</h1>
	<div id="contents">
		<div id="screen" class="picoImage picoTouch"></div>
	</div>
</div>
<h6 id="footer">
	<div id="author"></div>/
	<div id="version"></div>
</h6>
<!--script>console.log = () => {};</script!-->
<script src="picod.js"></script>
<script src="pico.js"></script>
<!--Event--><script>
pico.appurl = null; // Referenced url.
pico.appver = 0; // App version.

// On acction button.
async function picoOnAction() {
	let r = await appAction();
	if (pico.appver > 0) {
		picoSetStrings(pico.appver, "v");
	}
	if (r > 0) {
		if (pico.appurl) {
			await picoReload(pico.appurl);
		} else {
			await picoShare();
		}
	} else if (r < 0) {
		picoSetStrings("./index.html", "u");
		await picoReload("pico.html");
	}
}

// On select button.
async function picoOnSelect(x) {
	let r = await appSelect(x);
	if (pico.appver > 0) {
		picoSetStrings(pico.appver, "v");
	}
	if (r > 0) {
		await picoShare();
	} else if (r < 0) {
		picoSetStrings("./index.html", "u");
		await picoReload("pico.html");
	}
}

// On main loop.
async function picoOnMain() {
	pico.appurl = picoStrings("u");
	if (pico.appurl) {
		picoLabel("title");
		picoLabel("subtitle");
	}
	pico.appver = picoStrings("v");
	await appLoad();
	for (;;) {
		await appInit();
		for (;;) {
			picoClear();
			let r = await appMain();
			await picoFlip(0);
			await picoRead();
			if (r <= 0) {
				break;
			}
		}
	}
}

// Update title.
function picoTitle(text=null) {
	let e = document.getElementsByTagName("title");
	if (e && e[0]) {
		if (text) {
			e[0].style.display = "flex";
			e[0].innerText = text;
		} else {
			e[0].style.display = "none";
			e[0].innerText = "";
		}
	}
	picoLabel("title", text);
}

// Update label.
function picoLabel(id, text=null, icon=null) {
	let e = document.getElementById(id);
	if (e) {
		e.style.display = (text || icon) ? "flex" : "none";
		let e1 = document.getElementById(id + "Text");
		let e2 = document.getElementById(id + "Icon");
		if (e1 && text) {
			e1.style.display = "flex";
			e1.innerText = text;
			if (e2 && !icon) {
				e2.style.display = "none";
			}
		} else if (e2 && icon) {
			e2.style.display = "flex";
			e2.src = icon;
			if (e1 && !text) {
				e1.style.display = "none";
			}
		} else if (text) {
			e.innerText = text;
		}
	}
	picoFlush();
}

</script><!--/Event-->
<script src="app.js"></script>
<!--Main--><script>
picoOnMain();
</script><!--/Main-->
</body>
</html>
